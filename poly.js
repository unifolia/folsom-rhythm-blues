(()=>{var U=(e,n)=>()=>(e&&(n=e(e=0)),n);var $=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports);var M=(e,n,r)=>new Promise((p,c)=>{var G=u=>{try{j(r.next(u))}catch(L){c(L)}},h=u=>{try{j(r.throw(u))}catch(L){c(L)}},j=u=>u.done?p(u.value):Promise.resolve(u.value).then(G,h);j((r=r.apply(e,n)).next())});var l,m,s,ee,S,te,q,w,fe,B,ye,d,ne,H,ve,ge,I,E,oe,a,V=U(()=>{l=[1,5,8,13],m=[1,4,8,13],s=[1,1,5,8,11],ee=[1,1,6,8,11],S=[1,5,8,12],te={e:4,f:5,gb:6,g:7,ab:8,a:9,bb:10,b:11,c:0,db:1,d:2,eb:3},{e:q,f:w,gb:fe,g:B,ab:ye,a:d,bb:ne,b:H,c:ve,db:ge,d:I,eb:E}=te,oe={cmajor:l,cminor:m,c7:s,cmaj7:S,dmajor:l.map(e=>e+I),dminor:m.map(e=>e+I),d7:s.map(e=>e+I),ebmajor:l.map(e=>e+E),ebminor:m.map(e=>e+E),eb7:s.map(e=>e+E),emajor:l.map(e=>e+q),eminor:m.map(e=>e+q),e7:s.map(e=>e+q),fmajor:l.map(e=>e+w),fminor:m.map(e=>e+w),fmaj7:S.map(e=>e+w),gmajor:l.map(e=>e+B),gminor:m.map(e=>e+B),g7:s.map(e=>e+B),amajor:l.map(e=>e+d),aminor:m.map(e=>e+d),a7:s.map(e=>e+d),amaj7:S.map(e=>e+d),asus4:ee.map(e=>e+d),bbmajor:l.map(e=>e+ne),bmajor:l.map(e=>e+H),bminor:m.map(e=>e+H),b7:s.map(e=>e+H)},a=oe});var ae,C,z=U(()=>{ae=e=>{let r=Math.pow(2,.08333333333333333);return+(440*Math.pow(r,e+-22)).toFixed(4)},C=ae});var de=$(F=>{V();z();var D=document.querySelector(".dotA"),J=document.querySelector(".dotB"),k=document.querySelector("input#polyOne"),A=document.querySelector("input#polyTwo"),x=document.querySelector("input#tempo"),T=document.querySelector("input#volume"),v=document.querySelector("#play"),re=document.querySelector("#check"),i,o=[1],O=440,P=440,t=1,K=+T.value,Q,R,W,y,b=.01995,f=!1,ce=()=>M(F,null,function*(){i=new window.AudioContext}),X=()=>{y=60/+x.value*4*1e3-5},N=()=>{O=C(o[Math.floor(Math.random()*o.length)]),P=C(o[Math.floor(Math.random()*o.length)])},le=()=>{t>12&&(t=1),(t===1||t===7||t===11)&&(o=a.emajor),t===5&&(o=a.amajor),t===9&&(o=a.b7),N()},me=()=>{t>4&&(t=1),t===1&&(o=a.eminor),t===2&&(o=a.gmajor),t===3&&(o=a.dmajor),t===4&&(o=a.asus4),N()},ue=()=>{t>4&&(t=1),t===1&&(o=a.ebmajor),t===2&&(o=a.fmajor),t===3&&(o=a.gmajor),N()},se=()=>{let e=document.querySelector("input:checked");e!=null&&e.value&&(+e.value==1&&le(),+e.value==2&&me(),+e.value==3&&ue())},ie=(e,n)=>M(F,null,function*(){let r=i.createGain();r.gain.value=K/10,r.connect(i.destination);let p=i.createStereoPanner();p.pan.value=n==="left"?-.5:.5,p.connect(r);let c=i.createOscillator();c.type="square",c.frequency.setValueAtTime(e,i.currentTime),c.connect(p),c.start(),yield new Promise(h=>setTimeout(h,y*b)).then(()=>{c.stop(),c.disconnect()})}),g=(e,n)=>{ie(e,n)},Y=()=>{W=setTimeout(()=>{Z(),++t,f===!0?Y():_()},y),se(),g(O,"left"),g(P,"right"),Q=setInterval(()=>{g(O,"left")},y/+k.value),R=setInterval(()=>{g(P,"right")},y/+A.value)},Z=()=>{clearInterval(Q),clearInterval(R),X()},pe=()=>{v.classList.add("playing"),X(),Y(),v.innerText="Stop"},_=()=>{v.classList.remove("playing"),Z(),clearInterval(W),t=1,v.innerText="Play"};v.addEventListener("click",()=>{i||ce(),f=!f,f?pe():f||_()});re.addEventListener("click",()=>{b===.01995?b=b*40:b=.01995});k.oninput=()=>{document.querySelector(".polyOne").innerHTML=k.value};A.oninput=()=>{document.querySelector(".polyTwo").innerHTML=A.value};x.oninput=()=>{document.querySelector(".tempo").innerHTML=x.value};T.oninput=()=>{document.querySelector(".volume").innerHTML=T.value,K=+T.value};setInterval(()=>{D.style.backgroundColor="#22c1c3ba",J.style.backgroundColor="#d69916"},6e3);setInterval(()=>{D.style.backgroundColor="#d69916",J.style.backgroundColor="#22c1c3ba"},8e3)});de();})();
