(()=>{var V=(e,a)=>()=>(e&&(a=e(e=0)),a);var ce=(e,a)=>()=>(a||e((a={exports:{}}).exports,a),a.exports);var E=(e,a,i)=>new Promise((r,c)=>{var I=p=>{try{b(i.next(p))}catch(B){c(B)}},u=p=>{try{b(i.throw(p))}catch(B){c(B)}},b=p=>p.done?r(p.value):Promise.resolve(p.value).then(I,u);b((i=i.apply(e,a)).next())});var l,m,d,le,w,ue,k,C,Ie,A,qe,y,me,x,He,Be,O,P,se,o,z=V(()=>{l=[1,5,8,13],m=[1,4,8,13],d=[1,1,5,8,11],le=[1,1,6,8,11],w=[1,5,8,12],ue={e:4,f:5,gb:6,g:7,ab:8,a:9,bb:10,b:11,c:0,db:1,d:2,eb:3},{e:k,f:C,gb:Ie,g:A,ab:qe,a:y,bb:me,b:x,c:He,db:Be,d:O,eb:P}=ue,se={cmajor:l,cminor:m,c7:d,cmaj7:w,dmajor:l.map(e=>e+O),dminor:m.map(e=>e+O),d7:d.map(e=>e+O),ebmajor:l.map(e=>e+P),ebminor:m.map(e=>e+P),eb7:d.map(e=>e+P),emajor:l.map(e=>e+k),eminor:m.map(e=>e+k),e7:d.map(e=>e+k),fmajor:l.map(e=>e+C),fminor:m.map(e=>e+C),fmaj7:w.map(e=>e+C),gmajor:l.map(e=>e+A),gminor:m.map(e=>e+A),g7:d.map(e=>e+A),amajor:l.map(e=>e+y),aminor:m.map(e=>e+y),a7:d.map(e=>e+y),amaj7:w.map(e=>e+y),asus4:le.map(e=>e+y),bbmajor:l.map(e=>e+me),bmajor:l.map(e=>e+x),bminor:m.map(e=>e+x),b7:d.map(e=>e+x)},o=se});var pe,q,J=V(()=>{pe=e=>{let i=Math.pow(2,.08333333333333333);return+(440*Math.pow(i,e+-22)).toFixed(4)},q=pe});var Le=ce(U=>{z();J();var Q=document.querySelector(".dotA"),W=document.querySelector(".dotB"),X=document.querySelector(".polyOne"),Y=document.querySelector(".polyOne"),Z=document.querySelector(".tempo"),_=document.querySelector(".volume"),M=document.querySelector("input#polyOne"),h=document.querySelector("input#polyTwo"),j=document.querySelector("input#tempo"),f=document.querySelector("input#volume"),L=document.querySelector("#play"),de=document.querySelector("#check"),fe=document.querySelector("#midi"),s,n=[1],D=440,N=440,t=1,F=+f.value,$,ee,te,T,v=.01995,g=!1,K=!1,R=!1;setInterval(()=>{Q.style.backgroundColor="#22c1c3ba",W.style.backgroundColor="#d69916"},3e3);setInterval(()=>{Q.style.backgroundColor="#d69916",W.style.backgroundColor="#22c1c3ba"},4e3);var be=()=>{var e;(e=navigator==null?void 0:navigator.requestMIDIAccess({sysex:!0}))==null||e.then(a=>{G(),a.inputs.forEach(i=>i.onmidimessage=r=>{let c=r.data.length===3,I=r.data[0]>175,u=r.data[1],b=r.data[2]!==0;if(R===!0&&c&&b){if(+u==22){M.value=(r.data[2]/6.35).toString(),X.innerHTML=M.value;return}if(+u==23){h.value=(r.data[2]/6.35).toString(),Y.innerHTML=h.value;return}if(+u==24){j.value=(r.data[2]*1.716535).toString(),Z.innerHTML=j.value;return}if(+u==25){f.value=(r.data[2]/12.7).toString(),_.innerHTML=f.value,F=+f.value;return}if(I)return;oe(q(+r.data[1]-47),"center")}})},()=>{})},ne=()=>E(U,null,function*(){s=new window.AudioContext}),S=()=>{D=q(n[Math.floor(Math.random()*n.length)]),N=q(n[Math.floor(Math.random()*n.length)])},ye=()=>{t>12&&(t=1),(t===1||t===7||t===11)&&(n=o.emajor),t===5&&(n=o.amajor),t===9&&(n=o.b7),S()},ve=()=>{t>4&&(t=1),t===1&&(n=o.eminor),t===2&&(n=o.gmajor),t===3&&(n=o.dmajor),t===4&&(n=o.asus4),S()},ge=()=>{t>8&&(t=1),t===1&&(n=o.gmajor),t===3&&(n=o.bmajor),t===5&&(n=o.cmajor.map(e=>e+12)),t===7&&(n=o.cminor.map(e=>e+12)),S()},Te=()=>{t>8&&(t=1),(t===1||t===7)&&(n=o.cmajor),t===3&&(n=o.dminor),t===5&&(n=o.fmajor),S()},Me=()=>{t>4&&(t=1),t===1&&(n=o.ebmajor),t===2&&(n=o.fmajor),t===3&&(n=o.gmajor),S()},he=()=>{let e=document.querySelector("input:checked");e!=null&&e.value&&(+e.value==1&&ye(),+e.value==2&&ve(),+e.value==3&&ge(),+e.value==4&&Te(),+e.value==5&&Me())},G=()=>{T=60/+j.value*4*1e3-5},oe=(e,a)=>E(U,null,function*(){let i=s.createGain();i.gain.value=F/10,i.connect(s.destination);let r=s.createStereoPanner();r.pan.value=a==="left"?-.5:a==="right"?.5:0,r.connect(i);let c=s.createOscillator();c.type="square",c.frequency.setValueAtTime(e,s.currentTime),c.connect(r),c.start(),yield new Promise(u=>setTimeout(u,T*v)).then(()=>{c.stop(),c.disconnect()})}),H=(e,a)=>{oe(e,a)},ae=()=>{te=setTimeout(()=>{re(),++t,g===!0?ae():ie()},T),he(),H(D,"left"),H(N,"right"),$=setInterval(()=>{H(D,"left")},T/+M.value),ee=setInterval(()=>{H(N,"right")},T/+h.value)},re=()=>{clearInterval($),clearInterval(ee),G()},je=()=>{L.classList.add("playing"),G(),ae(),L.innerText="Stop"},ie=()=>{L.classList.remove("playing"),re(),clearInterval(te),t=1,L.innerText="Play"};L.addEventListener("click",()=>{s||ne(),g=!g,g?je():g||ie()});de.addEventListener("click",()=>{v===.01995?v=v*40:v=.01995});fe.addEventListener("click",()=>{s||ne(),K||(be(),K=!0),R=!R});M.oninput=()=>{X.innerHTML=M.value};h.oninput=()=>{Y.innerHTML=h.value};j.oninput=()=>{Z.innerHTML=j.value};f.oninput=()=>{_.innerHTML=f.value,F=+f.value}});Le();})();
