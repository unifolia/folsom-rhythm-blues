(()=>{var U=(e,a)=>()=>(e&&(a=e(e=0)),a);var $=(e,a)=>()=>(a||e((a={exports:{}}).exports,a),a.exports);var S=(e,a,r)=>new Promise((p,c)=>{var G=u=>{try{L(r.next(u))}catch(M){c(M)}},h=u=>{try{L(r.throw(u))}catch(M){c(M)}},L=u=>u.done?p(u.value):Promise.resolve(u.value).then(G,h);L((r=r.apply(e,a)).next())});var m,l,i,ee,q,te,w,B,ve,H,ge,d,oe,I,je,Te,E,C,ne,n,V=U(()=>{m=[1,5,8,13],l=[1,4,8,13],i=[1,1,5,8,11],ee=[1,1,6,8,11],q=[1,5,8,12],te={e:4,f:5,gb:6,g:7,ab:8,a:9,bb:10,b:11,c:0,db:1,d:2,eb:3},{e:w,f:B,gb:ve,g:H,ab:ge,a:d,bb:oe,b:I,c:je,db:Te,d:E,eb:C}=te,ne={cmajor:m,cminor:l,c7:i,cmaj7:q,dmajor:m.map(e=>e+E),dminor:l.map(e=>e+E),d7:i.map(e=>e+E),ebmajor:m.map(e=>e+C),ebminor:l.map(e=>e+C),eb7:i.map(e=>e+C),emajor:m.map(e=>e+w),eminor:l.map(e=>e+w),e7:i.map(e=>e+w),fmajor:m.map(e=>e+B),fminor:l.map(e=>e+B),fmaj7:q.map(e=>e+B),gmajor:m.map(e=>e+H),gminor:l.map(e=>e+H),g7:i.map(e=>e+H),amajor:m.map(e=>e+d),aminor:l.map(e=>e+d),a7:i.map(e=>e+d),amaj7:q.map(e=>e+d),asus4:ee.map(e=>e+d),bbmajor:m.map(e=>e+oe),bmajor:m.map(e=>e+I),bminor:l.map(e=>e+I),b7:i.map(e=>e+I)},n=ne});var ae,k,z=U(()=>{ae=e=>{let r=Math.pow(2,.08333333333333333);return+(440*Math.pow(r,e+-22)).toFixed(4)},k=ae});var be=$(F=>{V();z();var D=document.querySelector(".dotA"),J=document.querySelector(".dotB"),A=document.querySelector("input#polyOne"),x=document.querySelector("input#polyTwo"),O=document.querySelector("input#tempo"),T=document.querySelector("input#volume"),v=document.querySelector("#play"),re=document.querySelector("#check"),s,o=[1],P=440,N=440,t=1,K=+T.value,Q,R,W,y,f=.01995,b=!1;setInterval(()=>{D.style.backgroundColor="#22c1c3ba",J.style.backgroundColor="#d69916"},3e3);setInterval(()=>{D.style.backgroundColor="#d69916",J.style.backgroundColor="#22c1c3ba"},4e3);var ce=()=>S(F,null,function*(){s=new window.AudioContext}),X=()=>{y=60/+O.value*4*1e3-5},g=()=>{P=k(o[Math.floor(Math.random()*o.length)]),N=k(o[Math.floor(Math.random()*o.length)])},me=()=>{t>12&&(t=1),(t===1||t===7||t===11)&&(o=n.emajor),t===5&&(o=n.amajor),t===9&&(o=n.b7),g()},le=()=>{t>4&&(t=1),t===1&&(o=n.eminor),t===2&&(o=n.gmajor),t===3&&(o=n.dmajor),t===4&&(o=n.asus4),g()},ue=()=>{t>8&&(t=1),t===1&&(o=n.gmajor),t===3&&(o=n.bmajor),t===5&&(o=n.cmajor.map(e=>e+12)),t===7&&(o=n.cminor.map(e=>e+12)),g()},ie=()=>{t>8&&(t=1),(t===1||t===7)&&(o=n.cmajor),t===3&&(o=n.dminor),t===5&&(o=n.fmajor),g()},se=()=>{t>4&&(t=1),t===1&&(o=n.ebmajor),t===2&&(o=n.fmajor),t===3&&(o=n.gmajor),g()},pe=()=>{let e=document.querySelector("input:checked");e!=null&&e.value&&(+e.value==1&&me(),+e.value==2&&le(),+e.value==3&&ue(),+e.value==4&&ie(),+e.value==5&&se())},de=(e,a)=>S(F,null,function*(){let r=s.createGain();r.gain.value=K/10,r.connect(s.destination);let p=s.createStereoPanner();p.pan.value=a==="left"?-.5:.5,p.connect(r);let c=s.createOscillator();c.type="square",c.frequency.setValueAtTime(e,s.currentTime),c.connect(p),c.start(),yield new Promise(h=>setTimeout(h,y*f)).then(()=>{c.stop(),c.disconnect()})}),j=(e,a)=>{de(e,a)},Y=()=>{W=setTimeout(()=>{Z(),++t,b===!0?Y():_()},y),pe(),j(P,"left"),j(N,"right"),Q=setInterval(()=>{j(P,"left")},y/+A.value),R=setInterval(()=>{j(N,"right")},y/+x.value)},Z=()=>{clearInterval(Q),clearInterval(R),X()},fe=()=>{v.classList.add("playing"),X(),Y(),v.innerText="Stop"},_=()=>{v.classList.remove("playing"),Z(),clearInterval(W),t=1,v.innerText="Play"};v.addEventListener("click",()=>{s||ce(),b=!b,b?fe():b||_()});re.addEventListener("click",()=>{f===.01995?f=f*40:f=.01995});A.oninput=()=>{document.querySelector(".polyOne").innerHTML=A.value};x.oninput=()=>{document.querySelector(".polyTwo").innerHTML=x.value};O.oninput=()=>{document.querySelector(".tempo").innerHTML=O.value};T.oninput=()=>{document.querySelector(".volume").innerHTML=T.value,K=+T.value}});be();})();
